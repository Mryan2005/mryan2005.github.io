const SitesJS={requestAPI:(a,o,s)=>{let i=5;function l(){return new Promise((t,e)=>{let r=0;let n=setTimeout(()=>{if(r===0){r=2;n=null;e("请求超时");if(i==0){s()}}},5e3);fetch(a).then(function(e){if(r!==2){clearTimeout(n);t(e);n=null;r=1}if(e.ok){return e.json()}throw new Error("Network response was not ok.")}).then(function(e){i=0;o(e)}).catch(function(e){if(i>0){i-=1;setTimeout(()=>{l()},5e3)}else{s()}})})}l()},layout:a=>{const r=a.el;SitesJS.requestAPI(a.api,function(e){r.querySelector(".loading-wrap").remove();const t=e.content;var n="";t.forEach((e,t)=>{var r='<div class="site-card">';r+='<a class="card-link" target="_blank" rel="external noopener noreferrer" href="'+e.url+'">';r+='<img alt="'+e.title+'" src="'+(e.screenshot||"https://image.thum.io/get/width/1024/crop/768/"+e.url)+'" onerror="errorImgCover(this)"/>';r+='<div class="info">';r+='<img alt="'+e.title+'" src="'+(e.avatar||a.avatar)+'" onerror="errorImgAvatar(this)"/>';r+='<span class="title">'+e.title+"</span>";r+='<span class="desc">'+(e.description||e.url)+"</span>";r+="</div>";r+="</a>";r+="</div>";n+=r});r.querySelector(".group-body").innerHTML=n},function(){try{r.querySelector(".loading-wrap svg").remove();r.querySelector(".loading-wrap p").innerText("加载失败，请稍后重试。")}catch(e){}})},start:e=>{const t=document.getElementsByClassName("sitesjs-wrap");for(var r=0;r<t.length;r++){const n=t[r];const a=n.getAttribute("api");if(a==null){continue}var e=new Object;e.class=n.getAttribute("class");e.el=n;e.api=a;e.avatar=volantis.GLOBAL_CONFIG.default.link;e.screenshot=volantis.GLOBAL_CONFIG.default.cover;SitesJS.layout(e)}}};SitesJS.start();document.addEventListener("pjax:complete",function(){SitesJS.start()});