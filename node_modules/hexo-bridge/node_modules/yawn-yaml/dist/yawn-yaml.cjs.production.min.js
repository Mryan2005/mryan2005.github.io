"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("yaml-js"),r=require("js-yaml"),e=require("lodash");function n(t,r,e){if(i())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,r);var o=new(t.bind.apply(t,n));return e&&u(o,e.prototype),o}function i(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(i=function(){return!!t})()}function o(t){var r=function(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof r?r:r+""}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,r){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t})(t,r)}function l(t){var r="function"==typeof Map?new Map:void 0;return(l=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(r){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return n(t,arguments,a(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),u(e,t)})(t)}var s="tag:yaml.org,2002:map",f="tag:yaml.org,2002:seq",c=function(t){function r(r){var e;return(e=t.call(this,r)||this).message=r,e.name="YAWNError",e}var e,n;return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,u(e,n),r}(l(Error)),g=function(){function n(t){if(!e.isString(t))throw new TypeError("str should be a string");this.yaml=t}var i,a,u=n.prototype;return u.toString=function(){return this.yaml},u.toJSON=function(){return this.json},u.getRemark=function(r){var e=j(t.compose(this.yaml),r.split("."));return e&&function(t,r){for(var e=b(t).pointer;e<r.length&&"#"!==r[e]&&"\n"!==r[e];)++e;if("\n"===r[e]||e===r.length)return"";for(;e<r.length&&("#"===r[e]||" "===r[e]);)++e;for(var n=e;n<r.length&&"\n"!==r[n];)++n;return r.substring(e,n)}(e,this.yaml)},u.setRemark=function(r,e){var n=j(t.compose(this.yaml),r.split("."));return!!n&&!!(this.yaml=function(t,r,e){for(var n=b(t).pointer;n<e.length&&"#"!==e[n]&&"\n"!==e[n];)++n;if("\n"===e[n]||n===e.length)return e.substr(0,n)+" # "+r+e.substring(n);for(;n<e.length&&("#"===e[n]||" "===e[n]);)++n;for(var i=n;i<e.length&&"\n"!==e[i];)++i;return e.substr(0,n)+r+e.substring(i)}(n,e,this.yaml))},i=n,(a=[{key:"json",get:function(){return r.load(this.yaml)},set:function(r){if(!e.isEqual(this.json,r)){var n=t.compose(this.yaml);if(e.isUndefined(r))this.yaml="";else{var i=function(t){var r=null;if(e.isArray(t))r=f;else if(e.isObject(t))r=s;else if(e.isNull(t))r="tag:yaml.org,2002:null";else if(e.isNumber(t))r=t%10==0?"tag:yaml.org,2002:int":"tag:yaml.org,2002:float";else{if(!e.isString(t))throw new c("Unknown type");r="tag:yaml.org,2002:str"}return r}(r);if(n.tag===i){var o,a,u;e.includes(["tag:yaml.org,2002:null","tag:yaml.org,2002:str","tag:yaml.org,2002:int","tag:yaml.org,2002:float"],n.tag)?this.yaml=y(n,r,this.yaml,0):(n.tag===s&&(this.yaml=function t(r,n,i,o,a){return e.each(r.value,(function(r){var u=r[0],l=r[1];if(e.isUndefined(n[u.value])){var s=o.substr(0,u.start_mark.pointer+a)+o.substring(b(l).pointer+a);return a=a+s.length-o.length,void(o=s)}var f=i[u.value],c=n[u.value];if(c!==f&&!e.isArray(l.value)){var g=y(l,c,o,a);a=a+g.length-o.length,o=g,delete n[u.value]}if(!e.isEqual(c,f)&&e.isArray(l.value))if(e.isArray(c)){var m=p(l,c,o,a);a=a+m.length-o.length,o=m}else{var h=t(l,c,f,o,a);a=a+h.length-o.length,o=h,delete n[u.value]}})),e.each(n,(function(t,n){if(e.isUndefined(i[n])){var u,l=_(((u={})[n]=t,u)),s=m(r,l,o,a);a=a+s.length-o.length,o=s}})),o}(n,r,this.json,this.yaml,0)),n.tag===f&&(this.yaml=p(n,r,this.yaml,0)),this.yaml=this.yaml.split("\n").map((function(t){return t.replace(/[ \t]+$/,"")})).join("\n"))}else{var l=_(r);this.yaml=e.isObject(r)?(a=this.yaml,u=d(l,(o=n).start_mark.column),a.substr(0,o.start_mark.pointer-o.start_mark.column+0)+u+a.substring(b(o).pointer+0)):y(n,l,this.yaml,0)}}}}}])&&function(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o(n.key),n)}}(i.prototype,a),Object.defineProperty(i,"prototype",{writable:!1}),i}();function p(e,n,i,o){for(var a=r.load(t.serialize(e)),u=Math.min(a.length,n.length),l=0;l<u;l++){var s=v(e.value[l],_(n[l]),i,o);o=o+s.length-i.length,i=s}if(a.length>u)for(var f=u;f<a.length;f++){var c=h(e.value[f],i,o);o=o+c.length-i.length,i=c}else n.length>u&&(i=m(e,_(n.slice(u)),i,o));return i}function y(t,r,e,n){return e.substr(0,t.start_mark.pointer+n)+String(r)+e.substring(t.end_mark.pointer+n)}function m(t,r,e,n){var i=d(r,t.start_mark.column);return e.substr(0,b(t).pointer+n)+"\n"+i+e.substring(b(t).pointer+n)}function h(t,r,e){return r.substr(0,t.start_mark.pointer-t.start_mark.column-1+e)+r.substring(b(t).pointer+e)}function v(t,r,e,n){for(var i=d(r,t.start_mark.column),o=t.start_mark.pointer+n;o>0&&"-"!==e[o];)o--;return e.substr(0,o+2)+i.substr(t.start_mark.column)+e.substring(b(t).pointer+n)}function b(t){if(e.isArray(t.value)&&t.value.length){var r=e.last(t.value);return e.isArray(r)&&r.length?b(e.last(r)):b(r)}return t.end_mark}function d(t,r){return t.split("\n").filter((function(t){return t})).map((function(t){return e.repeat(" ",r)+t})).join("\n")}function _(t){return r.dump(t).replace(/\n$/,"")}function j(t,r){if(r.length){if(t.tag===s){for(var e=t.value,n=0;n<e.length;++n){var i=e[n];if(r[0]===i[0].value)return j(i[1],r.slice(1))}return}if(t.tag===f)return t.value[r[0]]&&j(t.value[r[0]],r.slice(1))}return t}exports.YAWNError=c,exports.default=g;
//# sourceMappingURL=yawn-yaml.cjs.production.min.js.map
